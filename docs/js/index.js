(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

window.onload = function () {
  var root = d3.select('svg');
  var toolTip = d3.select('#tooltip');
  var viewWidth = +root.attr('viewBox').split(' ')[2];
  var viewHeight = +root.attr('viewBox').split(' ')[3];
  var sectionHeight = 500;
  var legendHeight = viewHeight - sectionHeight;
  var width = d3.select('body').node().offsetWidth;

  window.onresize = function () {
    width = d3.select('body').node().offsetWidth;
  };

  function setTooltip(e, t) {
    var d = d3.select(t).select('rect'),
        x = e.pageX - 230 * d3.event.pageX / width,
        y = e.pageY - 15 - toolTip.node().offsetHeight;
    toolTip.attr('data-value', d.attr('data-value')).attr('style', 'top: ' + y + 'px; left: ' + x + 'px; visibility: visible;');
    toolTip.text(d.attr('data-name'));
  }

  var toolTipHandler = {
    over: function over() {
      setTooltip(d3.event, this);
    },
    move: function move() {
      setTooltip(d3.event, this);
    },
    out: function out() {
      toolTip.attr('style', 'visibility: hidden;');
    } //toolTipHandler.out()

  };

  function wrap(data) {
    data.selectAll('text').each(function (d, i, a) {
      var words = d.data.name.split(/\s+/),
          width = d.x1 - d.x0 - 15,
          lineHeight = 1.1,
          text = d3.select(a[i]);
      var word,
          line = [],
          lineNumber = 1,
          tspan = text.append('tspan');

      while ((word = words.shift()) != undefined) {
        line.push(word);
        tspan.text(line.join(' '));

        if (tspan.node().getComputedTextLength() > width) {
          if (line.length > 1) {
            line.pop();
            tspan.text(line.join(' '));
            line = [word];
          } else {
            line = [];
          }

          tspan = text.append('tspan').attr('x', 0).attr('y', lineNumber++ * lineHeight + 'em').text(line.join(' '));
        }
      }
    });
  }

  function createSection(start, data) {
    var a = start.append('g').attr('width', viewWidth).attr('height', sectionHeight).attr('class', 'section').attr('data-name', data.name).attr('visibility', 'hidden');
    a.call(createTile, data, a).call(wrap, function (d) {
      return d;
    });
  }

  function createTile(g, data) {
    var hRoot = d3.hierarchy(data).sum(function (d) {
      return d.value;
    });
    var treemapLayout = d3.treemap().size([viewWidth, sectionHeight]).paddingInner(1);
    var color = d3.scaleOrdinal(d3.schemeCategory20, hRoot.leaves().map(function (d) {
      return d.name;
    }));
    treemapLayout(hRoot);
    var res = g.node();
    var a = d3.select(res).selectAll('g').data(hRoot.leaves()).enter().append('g').attr('class', 'tileGroup').attr('transform', function (d) {
      return "translate(".concat(d.x0, ",").concat(d.y0, ")");
    }).on('mouseover', toolTipHandler.over).on('mousemove', toolTipHandler.move).on('mouseout', toolTipHandler.out);
    a.append('rect').attr('class', 'tile').attr('data-name', function (d) {
      return d.data.name;
    }).attr('data-category', function (d) {
      return d.data.category;
    }).attr('data-value', function (d) {
      return d.value;
    }).attr('width', function (d) {
      return d.x1 - d.x0;
    }).attr('height', function (d) {
      return d.y1 - d.y0;
    }).attr('fill', function (d) {
      return color(d.data.category);
    });
    a.append('text').attr('transform', 'translate(4,12)').attr('clip-path', function (d) {
      return "polygon(0 0, ".concat(d.x1 - d.x0 - 4, " 0, ").concat(d.x1 - d.x0 - 4, " ").concat(d.y1 - d.y0 - 4, ", 0 ").concat(d.y1 - d.y0 - 4, ")");
    }).attr('class', 'h5').attr('width', function (d) {
      return d.x1 - d.x0;
    }).attr('height', function (d) {
      return d.y1 - d.y0;
    }).attr('data-name', function (d) {
      return d.data.name;
    });
    return res;
  }

  function positions(cnt) {
    var cols = 3;
    var i = 0;
    var l = 0;
    var res = [];

    while (i < cnt) {
      var j = 0;

      while (i < cnt && j < cols) {
        res.push([j++ * 200, l * 30]);
        i++;
      }

      l++;
    }

    return res;
  }

  function createLegends(start, data) {
    var color = {},
        pos = {};
    var a = start.append('g').attr('id', 'legend').attr('transform', "translate(250,".concat(sectionHeight + 50, ")")).attr('width', viewWidth).attr('height', legendHeight).selectAll('g').data(data).enter().append('g').attr('id', function (d) {
      color[d.name] = d3.scaleOrdinal(d3.schemeCategory20, d.children.map(function (d) {
        return d.name;
      }));
      pos[d.name] = d3.scaleOrdinal(positions(d.children.length), d.children.map(function (d) {
        return d.name;
      }));
      return d.name;
    }).attr('class', 'legend').attr('visibility', 'hidden').attr('data-name', function (d) {
      return d.name;
    }).selectAll('g').data(function (d) {
      return d.children;
    }).enter().append('g').attr('transform', function (d, e, f) {
      var i = f[0].parentNode.getAttribute('id');

      var _pos$i = pos[i](d.name),
          _pos$i2 = _slicedToArray(_pos$i, 2),
          x = _pos$i2[0],
          y = _pos$i2[1];

      return 'translate(' + x + ',' + y + ')';
    }).attr('y', function (d, e, f) {
      var i = f[0].parentNode.getAttribute('id');
      pos[i](d.name)[1];
    });
    a.append('rect').attr('class', 'legend-item').attr('fill', function (d, e, f) {
      var i = f[0].parentNode.parentNode.getAttribute('id');
      return color[i](d.name);
    });
    a.append('text').attr('transform', 'translate(27,18)').text(function (d) {
      return d.name;
    });
  }

  function setMouseHandlers() {
    var a = d3.selectAll('.section, .legend');

    function f1() {
      a.attr('visibility', 'hidden');
      a.nodes()[0].setAttribute('visibility', 'visible');
      a.nodes()[3].setAttribute('visibility', 'visible');
    }

    function f2() {
      a.attr('visibility', 'hidden');
      a.nodes()[1].setAttribute('visibility', 'visible');
      a.nodes()[4].setAttribute('visibility', 'visible');
    }

    function f3() {
      a.attr('visibility', 'hidden');
      a.nodes()[2].setAttribute('visibility', 'visible');
      a.nodes()[5].setAttribute('visibility', 'visible');
    }

    d3.select('#video').on('click', f1);
    d3.select('#movie').on('click', f2);
    d3.select('#kick').on('click', f3);
    f1();
  }

  d3.queue().defer(d3.json, 'https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/kickstarter-funding-data.json').defer(d3.json, 'https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/movie-data.json').defer(d3.json, 'https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/video-game-sales-data.json').await(function (error, kickstarterPledges, movieSales, videoGameSales) {
    if (error) throw error;
    createSection(root, kickstarterPledges);
    createSection(root, movieSales);
    createSection(root, videoGameSales);
    createLegends(root, [kickstarterPledges, movieSales, videoGameSales]);
    setMouseHandlers([kickstarterPledges, movieSales, videoGameSales]);
  });
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7O0FDQUEsTUFBTSxDQUFDLE1BQVAsR0FBZ0IsWUFBTTtBQUNwQixNQUFNLElBQUksR0FBRyxFQUFFLENBQUMsTUFBSCxDQUFVLEtBQVYsQ0FBYjtBQUNBLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQyxNQUFILENBQVUsVUFBVixDQUFoQjtBQUNBLE1BQU0sU0FBUyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUwsQ0FBVSxTQUFWLEVBQXFCLEtBQXJCLENBQTJCLEdBQTNCLEVBQWdDLENBQWhDLENBQW5CO0FBQ0EsTUFBTSxVQUFVLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBTCxDQUFVLFNBQVYsRUFBcUIsS0FBckIsQ0FBMkIsR0FBM0IsRUFBZ0MsQ0FBaEMsQ0FBcEI7QUFDQSxNQUFNLGFBQWEsR0FBRyxHQUF0QjtBQUNBLE1BQU0sWUFBWSxHQUFHLFVBQVUsR0FBRyxhQUFsQztBQUVBLE1BQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxNQUFILENBQVUsTUFBVixFQUFrQixJQUFsQixHQUF5QixXQUFyQzs7QUFFQSxFQUFBLE1BQU0sQ0FBQyxRQUFQLEdBQWtCLFlBQVc7QUFDM0IsSUFBQSxLQUFLLEdBQUcsRUFBRSxDQUFDLE1BQUgsQ0FBVSxNQUFWLEVBQWtCLElBQWxCLEdBQXlCLFdBQWpDO0FBQ0QsR0FGRDs7QUFJQSxXQUFTLFVBQVQsQ0FBcUIsQ0FBckIsRUFBd0IsQ0FBeEIsRUFBMkI7QUFDekIsUUFDRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE1BQUgsQ0FBVSxDQUFWLEVBQWEsTUFBYixDQUFvQixNQUFwQixDQUROO0FBQUEsUUFFRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUYsR0FBVyxNQUFNLEVBQUUsQ0FBQyxLQUFILENBQVMsS0FBZixHQUF1QixLQUZ4QztBQUFB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KCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gIGNvbnN0IHJvb3QgPSBkMy5zZWxlY3QoJ3N2ZycpXG4gIGNvbnN0IHRvb2xUaXAgPSBkMy5zZWxlY3QoJyN0b29sdGlwJylcbiAgY29uc3Qgdmlld1dpZHRoID0gK3Jvb3QuYXR0cigndmlld0JveCcpLnNwbGl0KCcgJylbMl1cbiAgY29uc3Qgdmlld0hlaWdodCA9ICtyb290LmF0dHIoJ3ZpZXdCb3gnKS5zcGxpdCgnICcpWzNdXG4gIGNvbnN0IHNlY3Rpb25IZWlnaHQgPSA1MDBcbiAgY29uc3QgbGVnZW5kSGVpZ2h0ID0gdmlld0hlaWdodCAtIHNlY3Rpb25IZWlnaHRcblxuICBsZXQgd2lkdGggPSBkMy5zZWxlY3QoJ2JvZHknKS5ub2RlKCkub2Zmc2V0V2lkdGhcblxuICB3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICB3aWR0aCA9IGQzLnNlbGVjdCgnYm9keScpLm5vZGUoKS5vZmZzZXRXaWR0aFxuICB9XG5cbiAgZnVuY3Rpb24gc2V0VG9vbHRpcCAoZSwgdCkge1xuICAgIGNvbnN0IFxuICAgICAgZCA9IGQzLnNlbGVjdCh0KS5zZWxlY3QoJ3JlY3QnKSxcbiAgICAgIHggPSBlLnBhZ2VYIC0gKDIzMCAqIGQzLmV2ZW50LnBhZ2VYIC8gd2lkdGgpLFxuICAgICAgeSA9IGUucGFnZVkgLSAxNSAtIHRvb2xUaXAubm9kZSgpLm9mZnNldEhlaWdodFxuXG4gICAgdG9vbFRpcFxuICAgICAgLmF0dHIoJ2RhdGEtdmFsdWUnLCBkLmF0dHIoJ2RhdGEtdmFsdWUnKSlcbiAgICAgIC5hdHRyKCdzdHlsZScsICd0b3A6ICcgKyAoeSkgKyAncHg7IGxlZnQ6ICcgKyAoeCkgKyAncHg7IHZpc2liaWxpdHk6IHZpc2libGU7JylcblxuICAgIHRvb2xUaXBcbiAgICAgIC50ZXh0KGQuYXR0cignZGF0YS1uYW1lJykpXG4gIH1cblxuICBsZXQgdG9vbFRpcEhhbmRsZXIgPSB7XG4gICAgb3ZlcjogZnVuY3Rpb24gKCkge1xuICAgICAgc2V0VG9vbHRpcChkMy5ldmVudCwgdGhpcylcbiAgICB9LFxuICAgIG1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHNldFRvb2x0aXAoZDMuZXZlbnQsIHRoaXMpXG4gICAgfSxcbiAgICBvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRvb2xUaXBcbiAgICAgICAgLmF0dHIoJ3N0eWxlJywgJ3Zpc2liaWxpdHk6IGhpZGRlbjsnKVxuICAgIH1cbiAgfVxuXG4gIC8vdG9vbFRpcEhhbmRsZXIub3V0KClcblxuICBmdW5jdGlvbiB3cmFwKGRhdGEpIHtcbiAgICBkYXRhXG4gICAgICAuc2VsZWN0QWxsKCd0ZXh0JylcbiAgICAgIC5lYWNoKChkLCBpLCBhKSA9PiB7XG4gICAgICAgIGNvbnN0IFxuICAgICAgICAgIHdvcmRzID0gZC5kYXRhLm5hbWUuc3BsaXQoL1xccysvKSxcbiAgICAgICAgICB3aWR0aCA9IGQueDEgLSBkLngwIC0gMTUsXG4gICAgICAgICAgbGluZUhlaWdodCA9IDEuMSxcbiAgICAgICAgICB0ZXh0ID0gIGQzLnNlbGVjdChhW2ldKVxuXG4gICAgICAgIGxldFxuICAgICAgICAgIHdvcmQsXG4gICAgICAgICAgbGluZSA9IFtdLFxuICAgICAgICAgIGxpbmVOdW1iZXIgPSAxLFxuICAgICAgICAgIHRzcGFuID0gdGV4dFxuICAgICAgICAgICAgLmFwcGVuZCgndHNwYW4nKVxuXG4gICAgICAgIHdoaWxlICgod29yZCA9IHdvcmRzLnNoaWZ0KCkpICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGxpbmUucHVzaCh3b3JkKVxuICAgICAgICAgIHRzcGFuLnRleHQobGluZS5qb2luKCcgJykpXG4gICAgICAgICAgaWYgKHRzcGFuLm5vZGUoKS5nZXRDb21wdXRlZFRleHRMZW5ndGgoKSA+IHdpZHRoKSB7XG4gICAgICAgICAgICBpZiAobGluZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIGxpbmUucG9wKClcbiAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oJyAnKSlcbiAgICAgICAgICAgICAgbGluZSA9IFt3b3JkXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIGxpbmUgPSBbXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHNwYW4gPSB0ZXh0XG4gICAgICAgICAgICAgIC5hcHBlbmQoJ3RzcGFuJylcbiAgICAgICAgICAgICAgLmF0dHIoJ3gnLCAwKVxuICAgICAgICAgICAgICAuYXR0cigneScsIChsaW5lTnVtYmVyKysgKiBsaW5lSGVpZ2h0KSArICdlbScpXG4gICAgICAgICAgICAgIC50ZXh0KGxpbmUuam9pbignICcpKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVNlY3Rpb24gKHN0YXJ0LCBkYXRhKSB7XG4gICAgY29uc3QgYSA9IHN0YXJ0XG5cbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ3dpZHRoJywgdmlld1dpZHRoKVxuICAgICAgLmF0dHIoJ2hlaWdodCcsIHNlY3Rpb25IZWlnaHQpXG4gICAgICAuYXR0cignY2xhc3MnLCAnc2VjdGlvbicpXG4gICAgICAuYXR0cignZGF0YS1uYW1lJywgZGF0YS5uYW1lKVxuICAgICAgLmF0dHIoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJylcblxuICAgIGEgLmNhbGwoY3JlYXRlVGlsZSwgZGF0YSwgYSlcbiAgICAgIC5jYWxsKHdyYXAsIGQgPT4gZClcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVRpbGUgKGcsIGRhdGEpIHtcbiAgICBjb25zdCBoUm9vdCA9IGQzLmhpZXJhcmNoeShkYXRhKS5zdW0oZCA9PiBkLnZhbHVlKVxuICAgIGNvbnN0IHRyZWVtYXBMYXlvdXQgPSBkMy50cmVlbWFwKCkuc2l6ZShbdmlld1dpZHRoLCBzZWN0aW9uSGVpZ2h0XSkucGFkZGluZ0lubmVyKDEpXG4gICAgY29uc3QgY29sb3IgPSBkMy5zY2FsZU9yZGluYWwoZDMuc2NoZW1lQ2F0ZWdvcnkyMCwgaFJvb3QubGVhdmVzKCkubWFwKGQgPT4gZC5uYW1lKSlcblxuICAgIHRyZWVtYXBMYXlvdXQoaFJvb3QpXG5cbiAgICBjb25zdCByZXMgPSBnLm5vZGUoKVxuXG4gICAgY29uc3QgYSA9IGQzLnNlbGVjdChyZXMpXG4gICAgICAuc2VsZWN0QWxsKCdnJylcbiAgICAgIC5kYXRhKGhSb290LmxlYXZlcygpKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ3RpbGVHcm91cCcpXG4gICAgICAuYXR0cigndHJhbnNmb3JtJywgZCA9PiBgdHJhbnNsYXRlKCR7ZC54MH0sJHtkLnkwfSlgKVxuICAgICAgLm9uKCdtb3VzZW92ZXInLCB0b29sVGlwSGFuZGxlci5vdmVyKVxuICAgICAgLm9uKCdtb3VzZW1vdmUnLCB0b29sVGlwSGFuZGxlci5tb3ZlKVxuICAgICAgLm9uKCdtb3VzZW91dCcsIHRvb2xUaXBIYW5kbGVyLm91dClcblxuICAgIGEgLmFwcGVuZCgncmVjdCcpXG4gICAgICAuYXR0cignY2xhc3MnLCAndGlsZScpXG4gICAgICAuYXR0cignZGF0YS1uYW1lJywgZCA9PiBkLmRhdGEubmFtZSlcbiAgICAgIC5hdHRyKCdkYXRhLWNhdGVnb3J5JywgZCA9PiBkLmRhdGEuY2F0ZWdvcnkpXG4gICAgICAuYXR0cignZGF0YS12YWx1ZScsIGQgPT4gZC52YWx1ZSlcbiAgICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gZC54MSAtIGQueDApXG4gICAgICAuYXR0cignaGVpZ2h0JywgZCA9PiBkLnkxIC0gZC55MClcbiAgICAgIC5hdHRyKCdmaWxsJywgZCA9PiBjb2xvcihkLmRhdGEuY2F0ZWdvcnkpKVxuXG4gICAgYSAuYXBwZW5kKCd0ZXh0JylcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDQsMTIpJylcbiAgICAgIC5hdHRyKCdjbGlwLXBhdGgnLCBkID0+IGBwb2x5Z29uKDAgMCwgJHsoZC54MSAtIGQueDApIC0gNH0gMCwgJHsoZC54MSAtIGQueDApIC0gNH0gJHsoZC55MSAtIGQueTApIC0gNH0sIDAgJHsoZC55MSAtIGQueTApIC0gNH0pYClcbiAgICAgIC5hdHRyKCdjbGFzcycsICdoNScpXG4gICAgICAuYXR0cignd2lkdGgnLCBkID0+IGQueDEgLSBkLngwKVxuICAgICAgLmF0dHIoJ2hlaWdodCcsIGQgPT4gZC55MSAtIGQueTApXG4gICAgICAuYXR0cignZGF0YS1uYW1lJywgZCA9PiBkLmRhdGEubmFtZSlcblxuICAgIHJldHVybiByZXNcbiAgfVxuXG4gIGZ1bmN0aW9uIHBvc2l0aW9ucyAoY250KSB7XG4gICAgbGV0IGNvbHMgPSAzXG4gICAgbGV0IGkgPSAwXG4gICAgbGV0IGwgPSAwXG4gICAgbGV0IHJlcyA9IFtdXG5cbiAgICB3aGlsZSAoaSA8IGNudCkge1xuICAgICAgbGV0IGogPSAwXG4gICAgICB3aGlsZSAoaSA8IGNudCAmJiBqIDwgY29scykge1xuICAgICAgICByZXMucHVzaChbaisrICogMjAwLGwgKiAzMF0pXG4gICAgICAgIGkrK1xuICAgICAgfVxuICAgICAgbCsrXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlTGVnZW5kcyAoc3RhcnQsIGRhdGEpIHtcbiAgICBsZXQgY29sb3IgPSB7fSwgcG9zID0ge31cbiAgICBjb25zdCBhID0gc3RhcnRcbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ2lkJywgJ2xlZ2VuZCcpXG4gICAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgyNTAsJHtzZWN0aW9uSGVpZ2h0ICsgNTB9KWApXG4gICAgICAuYXR0cignd2lkdGgnLCB2aWV3V2lkdGgpXG4gICAgICAuYXR0cignaGVpZ2h0JywgbGVnZW5kSGVpZ2h0KVxuICAgICAgLnNlbGVjdEFsbCgnZycpXG4gICAgICAuZGF0YShkYXRhKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ2lkJywgZCAgPT4ge1xuICAgICAgICBjb2xvcltkLm5hbWVdID0gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZUNhdGVnb3J5MjAsIGQuY2hpbGRyZW4ubWFwKGQgPT4gZC5uYW1lKSlcbiAgICAgICAgcG9zW2QubmFtZV0gPSBkMy5zY2FsZU9yZGluYWwocG9zaXRpb25zKGQuY2hpbGRyZW4ubGVuZ3RoKSwgZC5jaGlsZHJlbi5tYXAoZCA9PiBkLm5hbWUpKVxuICAgICAgICByZXR1cm4gZC5uYW1lXG4gICAgICB9KVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xlZ2VuZCcpXG4gICAgICAuYXR0cigndmlzaWJpbGl0eScsICdoaWRkZW4nKVxuICAgICAgLmF0dHIoJ2RhdGEtbmFtZScsIGQgPT4gZC5uYW1lKVxuICAgICAgLnNlbGVjdEFsbCgnZycpXG4gICAgICAuZGF0YShkID0+IGQuY2hpbGRyZW4pXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAuYXR0cigndHJhbnNmb3JtJywgKGQsZSxmKSA9PiB7XG4gICAgICAgIGxldCBpID0gZlswXS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnaWQnKVxuICAgICAgICBjb25zdCBbeCwgeV0gPSBwb3NbaV0oZC5uYW1lKVxuICAgICAgICByZXR1cm4gJ3RyYW5zbGF0ZSgnICsgeCArICcsJyArIHkgKyAnKSd9XG4gICAgICApXG4gICAgICAuYXR0cigneScsIChkLGUsZikgPT4ge1xuICAgICAgICBsZXQgaSA9IGZbMF0ucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2lkJylcbiAgICAgICAgcG9zW2ldKGQubmFtZSlbMV1cbiAgICAgIH0pXG5cbiAgICBhIC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xlZ2VuZC1pdGVtJylcbiAgICAgIC5hdHRyKCdmaWxsJywgKGQsZSxmKSA9PiB7XG4gICAgICAgIGxldCBpID0gZlswXS5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdpZCcpXG4gICAgICAgIHJldHVybiBjb2xvcltpXShkLm5hbWUpXG4gICAgICB9KVxuXG4gICAgYSAuYXBwZW5kKCd0ZXh0JylcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDI3LDE4KScpXG4gICAgICAudGV4dChkID0+IGQubmFtZSlcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldE1vdXNlSGFuZGxlcnMoKSB7XG4gICAgY29uc3QgYSA9IGQzLnNlbGVjdEFsbCgnLnNlY3Rpb24sIC5sZWdlbmQnKVxuICAgIGZ1bmN0aW9uIGYxICgpIHtcbiAgICAgIGEuYXR0cigndmlzaWJpbGl0eScsICdoaWRkZW4nKVxuICAgICAgYS5ub2RlcygpWzBdLnNldEF0dHJpYnV0ZSgndmlzaWJpbGl0eScsICd2aXNpYmxlJylcbiAgICAgIGEubm9kZXMoKVszXS5zZXRBdHRyaWJ1dGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgfVxuICAgIGZ1bmN0aW9uIGYyICgpIHtcbiAgICAgIGEuYXR0cigndmlzaWJpbGl0eScsICdoaWRkZW4nKVxuICAgICAgYS5ub2RlcygpWzFdLnNldEF0dHJpYnV0ZSgndmlzaWJpbGl0eScsICd2aXNpYmxlJylcbiAgICAgIGEubm9kZXMoKVs0XS5zZXRBdHRyaWJ1dGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgfVxuICAgIGZ1bmN0aW9uIGYzICgpIHtcbiAgICAgIGEuYXR0cigndmlzaWJpbGl0eScsICdoaWRkZW4nKVxuICAgICAgYS5ub2RlcygpWzJdLnNldEF0dHJpYnV0ZSgndmlzaWJpbGl0eScsICd2aXNpYmxlJylcbiAgICAgIGEubm9kZXMoKVs1XS5zZXRBdHRyaWJ1dGUoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgfVxuICAgIGQzLnNlbGVjdCgnI3ZpZGVvJylcbiAgICAgIC5vbignY2xpY2snLCBmMSlcblxuICAgIGQzLnNlbGVjdCgnI21vdmllJylcbiAgICAgIC5vbignY2xpY2snLCBmMilcblxuICAgIGQzLnNlbGVjdCgnI2tpY2snKVxuICAgICAgLm9uKCdjbGljaycsIGYzKVxuXG4gICAgZjEoKVxuICB9XG5cbiAgZDMucXVldWUoKVxuICAgIC5kZWZlcihkMy5qc29uLCAnaHR0cHM6Ly9jZG4ucmF3Z2l0LmNvbS9mcmVlQ29kZUNhbXAvdGVzdGFibGUtcHJvamVjdHMtZmNjL2E4MGNlOGY5L3NyYy9kYXRhL3RyZWVfbWFwL2tpY2tzdGFydGVyLWZ1bmRpbmctZGF0YS5qc29uJylcbiAgICAuZGVmZXIoZDMuanNvbiwgJ2h0dHBzOi8vY2RuLnJhd2dpdC5jb20vZnJlZUNvZGVDYW1wL3Rlc3RhYmxlLXByb2plY3RzLWZjYy9hODBjZThmOS9zcmMvZGF0YS90cmVlX21hcC9tb3ZpZS1kYXRhLmpzb24nKVxuICAgIC5kZWZlcihkMy5qc29uLCAnaHR0cHM6Ly9jZG4ucmF3Z2l0LmNvbS9mcmVlQ29kZUNhbXAvdGVzdGFibGUtcHJvamVjdHMtZmNjL2E4MGNlOGY5L3NyYy9kYXRhL3RyZWVfbWFwL3ZpZGVvLWdhbWUtc2FsZXMtZGF0YS5qc29uJylcbiAgICAuYXdhaXQoKGVycm9yLCBraWNrc3RhcnRlclBsZWRnZXMsIG1vdmllU2FsZXMsIHZpZGVvR2FtZVNhbGVzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIGNyZWF0ZVNlY3Rpb24ocm9vdCwga2lja3N0YXJ0ZXJQbGVkZ2VzKVxuICAgICAgY3JlYXRlU2VjdGlvbihyb290LCBtb3ZpZVNhbGVzKVxuICAgICAgY3JlYXRlU2VjdGlvbihyb290LCB2aWRlb0dhbWVTYWxlcylcbiAgICAgIGNyZWF0ZUxlZ2VuZHMocm9vdCwgW2tpY2tzdGFydGVyUGxlZGdlcywgbW92aWVTYWxlcywgdmlkZW9HYW1lU2FsZXNdKVxuXG4gICAgICBzZXRNb3VzZUhhbmRsZXJzKFtraWNrc3RhcnRlclBsZWRnZXMsIG1vdmllU2FsZXMsIHZpZGVvR2FtZVNhbGVzXSlcbiAgICB9KVxufSJdfQ==
